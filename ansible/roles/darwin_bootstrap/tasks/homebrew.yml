---

- name: Install Homebrew taps
  community.general.homebrew_tap:
    name: "{{ item }}"
    state: present
  with_items: "{{ homebrew_taps }}"
  tags: homebrew

- name: Remove conflicting apps before cask installation
  file:
    path: "/Applications/{{ item }}"
    state: absent
  become: true
  ignore_errors: true
  with_items:
    - "Scroll Reverser.app"
    - "SizeUp.app"
  tags: homebrew

- name: Install Homebrew casks
  community.general.homebrew_cask:
    name: "{{ item }}"
    state: present
    update_homebrew: yes
    greedy: yes
  with_items: "{{ homebrew_casks }}"
  tags:
    - homebrew
    - docker

- name: Install Homebrew packages
  community.general.homebrew:
    name: "{{ homebrew_packages }}"
    state: present
    update_homebrew: yes
  tags:
    - homebrew
    - git
    - rbenv
    - ruby
